<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>B Related Tools | Data Integration, Manipulation and Visualization of Phylogenetic Trees</title>
<meta name="author" content="Guangchuang Yu">
<meta name="description" content="B.1 MicrobiotaProcess: Convert Taxonomy Table to a treedata Object Taxonomy (genus, family, …) data are widely used in microbiome or ecology. Hierarchical taxonomies are the tree-like structure...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="B Related Tools | Data Integration, Manipulation and Visualization of Phylogenetic Trees">
<meta property="og:type" content="book">
<meta property="og:image" content="/book-cover.png">
<meta property="og:description" content="B.1 MicrobiotaProcess: Convert Taxonomy Table to a treedata Object Taxonomy (genus, family, …) data are widely used in microbiome or ecology. Hierarchical taxonomies are the tree-like structure...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="B Related Tools | Data Integration, Manipulation and Visualization of Phylogenetic Trees">
<meta name="twitter:description" content="B.1 MicrobiotaProcess: Convert Taxonomy Table to a treedata Object Taxonomy (genus, family, …) data are widely used in microbiome or ecology. Hierarchical taxonomies are the tree-like structure...">
<meta name="twitter:image" content="/book-cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap/bootstrap.bundle.min.js"></script><script src="libs/bs3compat/transition.js"></script><script src="libs/bs3compat/tabs.js"></script><script src="libs/bs3compat/bs3compat.js"></script><link href="libs/bs4_book/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book/bs4_book.js"></script><script src="libs/kePrint/kePrint.js"></script><link href="libs/lightable/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets/htmlwidgets.js"></script><script src="libs/pathseg/pathseg.js"></script><script src="libs/comic/comic.min.js"></script><script src="libs/comicR-binding/comicR.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Integration, Manipulation and Visualization of Phylogenetic Trees</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="author.html">About the Author</a></li>
<li class="book-part">Part I: Tree data input, output, and manipulation</li>
<li><a class="" href="chapter1.html"><span class="header-section-number">1</span> Importing Tree with Data</a></li>
<li><a class="" href="chapter2.html"><span class="header-section-number">2</span> Manipulating Tree with Data</a></li>
<li><a class="" href="chapter3.html"><span class="header-section-number">3</span> Exporting tree with data</a></li>
<li class="book-part">Part II: Tree data visualization and annotation</li>
<li><a class="" href="chapter4.html"><span class="header-section-number">4</span> Phylogenetic Tree Visualization</a></li>
<li><a class="" href="chapter5.html"><span class="header-section-number">5</span> Phylogenetic Tree Annotation</a></li>
<li><a class="" href="chapter6.html"><span class="header-section-number">6</span> Visual Exploration of Phylogenetic Trees</a></li>
<li><a class="" href="chapter7.html"><span class="header-section-number">7</span> Plotting tree with data</a></li>
<li><a class="" href="chapter8.html"><span class="header-section-number">8</span> Annotating Tree with Silhouette Images and Sub-plots</a></li>
<li><a class="" href="chapter9.html"><span class="header-section-number">9</span> ggtree for Other Tree-like Objects</a></li>
<li class="book-part">Part III: ggtree extensions</li>
<li><a class="" href="chapter10.html"><span class="header-section-number">10</span> ggtreeExtra for Presenting Data on a Circular Layout</a></li>
<li><a class="" href="chapter11.html"><span class="header-section-number">11</span> Other ggtree Extensions</a></li>
<li class="book-part">Part IV: Miscellaneous topics</li>
<li><a class="" href="chapter12.html"><span class="header-section-number">12</span> ggtree Utilities</a></li>
<li><a class="" href="chapter13.html"><span class="header-section-number">13</span> Gallery of Reproducible Examples</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="faq.html"><span class="header-section-number">A</span> Frequently Asked Questions</a></li>
<li><a class="active" href="related-tools.html"><span class="header-section-number">B</span> Related Tools</a></li>
<li><a class="" href="figures-and-tables.html"><span class="header-section-number">C</span> Figures and Tables</a></li>
<li><a class="" href="publications-of-the-ggtree-package-suite.html"><span class="header-section-number">D</span> Publications of the ggtree Package Suite</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="related-tools" class="section level1" number="15">
<h1>
<span class="header-section-number">B</span> Related Tools<a class="anchor" aria-label="anchor" href="#related-tools"><i class="fas fa-link"></i></a>
</h1>
<div id="MicrobiotaProcess-taxonomy" class="section level2" number="15.1">
<h2>
<span class="header-section-number">B.1</span> MicrobiotaProcess: Convert Taxonomy Table to a <code>treedata</code> Object<a class="anchor" aria-label="anchor" href="#MicrobiotaProcess-taxonomy"><i class="fas fa-link"></i></a>
</h2>
<p>Taxonomy (genus, family, …) data are widely used in microbiome or ecology. Hierarchical taxonomies are the tree-like structure that organizes items into subcategories and can be converted to a tree object (see also the <a href="chapter9.html#phylog">phylog object</a>). The <a href="http://bioconductor.org/packages/MicrobiotaProcess"><strong>MicrobiotaProcess</strong></a> supports converting a <code>taxonomyTable</code> object, defined in the <a href="http://bioconductor.org/packages/phyloseq"><strong>phyloseq</strong></a> package, to a <code>treedata</code> object, and the taxonomic hierarchical relationship can be visualized using <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> (Figure <a href="related-tools.html#fig:TaxaTree">B.1</a>). When there are taxonomy names that are <a href="https://github.com/YuLab-SMU/MicrobiotaProcess/issues/14">confused and missing</a>, the <code><a href="https://rdrr.io/pkg/tidytree/man/as.treedata.html">as.treedata()</a></code> method for <code>taxonomyTable</code> objects will complete their upper-level taxonomic information automatically.</p>


<div class="sourceCode" id="cb296"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/YuLab-SMU/MicrobiotaProcess/">MicrobiotaProcess</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/treedata-book/">ggtree</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The original kostic2012crc is a MPSE object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">kostic2012crc</span><span class="op">)</span></span>
<span></span>
<span><span class="va">taxa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MicrobiotaProcess/man/MPSE-accessors.html">tax_table</a></span><span class="op">(</span><span class="va">kostic2012crc</span><span class="op">)</span></span>
<span><span class="co">#The rownames (usually is OTUs or other features ) of the taxa will be </span></span>
<span><span class="co"># served as the tip labels if include.rownames = TRUE</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tidytree/man/as.treedata.html">as.treedata</a></span><span class="op">(</span><span class="va">taxa</span>, include.rownames<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Or extract the taxa tree (treedata) with mp_extract_tree, because the </span></span>
<span><span class="co"># taxonomy information is stored as treedata in the MPSE class (kostic2012crc).</span></span>
<span><span class="co"># tree &lt;- kostic2012crc %&gt;% mp_extract_tree()</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">tree</span>, layout<span class="op">=</span><span class="st">"circular"</span>, size<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tiplab.html">geom_tiplab</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:TaxaTree"></span>
<img src="treedata_files/figure-html/TaxaTree-1.png" alt="Convert a taxonomyTable object to a treedata object." width="98%"><p class="caption">
FIGURE B.1: <strong>Convert a <code>taxonomyTable</code> object to a <code>treedata</code> object.</strong>
</p>
</div>
</div>
<div id="rtol" class="section level2" number="15.2">
<h2>
<span class="header-section-number">B.2</span> rtol: An R Interface to Open Tree API<a class="anchor" aria-label="anchor" href="#rtol"><i class="fas fa-link"></i></a>
</h2>
<p>The <a href="https://CRAN.R-project.org/package=rtol"><strong>rtol</strong></a> <span class="citation">(<a href="references.html#ref-michonneau_rotl:_2016" role="doc-biblioref">Michonneau et al., 2016</a>)</span> is an R package to interact with the Open Tree of Life data APIs. Users can use it to query phylogenetic trees and visualize the trees with <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> to explore species relationships (Figure <a href="related-tools.html#fig:rotlSubtree">B.2</a>).</p>


<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## example from: https://github.com/ropensci/rotl</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rotl/">rotl</a></span><span class="op">)</span></span>
<span><span class="va">apes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pongo"</span>, <span class="st">"Pan"</span>, <span class="st">"Gorilla"</span>, <span class="st">"Hoolock"</span>, <span class="st">"Homo"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">resolved_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rotl/reference/tnrs_match_names.html">tnrs_match_names</a></span><span class="op">(</span><span class="va">apes</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   search_string unique_name approximate_match ott_id
## 1         pongo       Pongo             FALSE 417949
## 2           pan         Pan             FALSE 417957
## 3       gorilla     Gorilla             FALSE 417969
## 4       hoolock     Hoolock             FALSE 712902
## 5          homo        Homo             FALSE 770309
##   is_synonym          flags number_matches
## 1      FALSE                             2
## 2      FALSE sibling_higher              2
## 3      FALSE sibling_higher              1
## 4      FALSE                             1
## 5      FALSE sibling_higher              1</code></pre>
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/rotl/reference/tol_induced_subtree.html">tol_induced_subtree</a></span><span class="op">(</span>ott_ids <span class="op">=</span> <span class="fu"><a href="https://docs.ropensci.org/rotl/reference/taxonomy-methods.html">ott_id</a></span><span class="op">(</span><span class="va">resolved_names</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">tr</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tiplab.html">geom_tiplab</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:rotlSubtree"></span>
<img src="treedata_files/figure-html/rotlSubtree-1.svg" alt="Get an induced subtree from the big Open Tree." width="100%"><p class="caption">
FIGURE B.2: <strong>Get an induced subtree from the big Open Tree.</strong>
</p>
</div>
</div>
<div id="plotly" class="section level2" number="15.3">
<h2>
<span class="header-section-number">B.3</span> Convert a <code>ggtree</code> object to a <code>plotly</code> object<a class="anchor" aria-label="anchor" href="#plotly"><i class="fas fa-link"></i></a>
</h2>
<p>One way to make a quick interactive phylogenetic tree is using <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> with the <a href="https://CRAN.R-project.org/package=plotly"><strong>plotly</strong></a> package. The <a href="https://plotly-r.com/improving-ggplotly.html">ggplotly()</a> is able to convert <code>ggtree</code> object to a <code>plotly</code> object. Note that the <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> package also supports interactive manipulation of the phylogenetic tree via the <a href="chapter12.html#identify">identify()</a> method.</p>
<div class="sourceCode" id="cb300"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example from https://twitter.com/drandersgs/status/965996335882059776</span></span>
<span></span>
<span><span class="co"># LOAD LIBS ---------------------------------------------------------------</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/treedata-book/">ggtree</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span></span>
<span><span class="co"># CREATE A TREE -------------------------------------------------------------</span></span>
<span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">n_grp</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html">rtree</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_samples</span><span class="op">)</span></span>
<span><span class="co"># CREATE SOME METADATA ----------------------------------------------------</span></span>
<span><span class="va">id</span> <span class="op">&lt;-</span> <span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n_grp</span><span class="op">]</span>, size <span class="op">=</span> <span class="va">n_samples</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">id</span>,</span>
<span>                      grp <span class="op">=</span> <span class="va">grp</span><span class="op">)</span></span>
<span><span class="co"># PLOT THE TREE -----------------------------------------------------------</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span>
<span><span class="va">metat</span> <span class="op">&lt;-</span> <span class="va">p1</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'label'</span> <span class="op">=</span> <span class="st">'id'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">metat</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,</span>
<span>                 y <span class="op">=</span> <span class="va">y</span>,</span>
<span>                 colour <span class="op">=</span> <span class="va">grp</span>,</span>
<span>                 label <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:ggtreeplotly"></span>
<img src="img/ggtree-plotly.gif" alt="Interactive phylogenetic tree by combining ggtree with plotly." width="100%"><p class="caption">
FIGURE B.3: <strong>Interactive phylogenetic tree by combining ggtree with plotly.</strong>
</p>
</div>
</div>
<div id="commicR" class="section level2" number="15.4">
<h2>
<span class="header-section-number">B.4</span> Comic (xkcd-like) phylogenetic tree<a class="anchor" aria-label="anchor" href="#commicR"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb301"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/htmltools">htmltools</a></span><span class="op">)</span>    </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.omegahat.net/RSXML/">XML</a></span><span class="op">)</span>    </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridSVG</span><span class="op">)</span>    </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>    </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/treedata-book/">ggtree</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">comicR</span><span class="op">)</span>    </span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html">rtree</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>, layout<span class="op">=</span><span class="st">"circular"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tiplab.html">geom_tiplab</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">label</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"purple"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/print-methods.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">svg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gridSVG/man/grid.export.html">grid.export</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">""</span>, res<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">$</span><span class="va">svg</span></span></code></pre></div>


<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## need to convert it to png or pdf for pdfbook</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagList.html">tagList</a></span><span class="op">(</span></span>
<span>    <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span></span>
<span>             id <span class="op">=</span> <span class="st">"ggtree_comic"</span>,</span>
<span>             <span class="va">tags</span><span class="op">$</span><span class="fu">style</span><span class="op">(</span><span class="st">"#ggtree_comic text {font-family:Comic Sans MS;}"</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/XML/man/saveXML.html">saveXML</a></span><span class="op">(</span><span class="va">svg</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/comicR/man/comicR.html">comicR</a></span><span class="op">(</span><span class="st">"#ggtree_comic"</span>, ff<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span>         <span class="op">)</span></span>
<span><span class="op">)</span> <span class="co"># %&gt;% html_print</span></span></code></pre></div>
<div id="ggtree_comic">
<style>#ggtree_comic text {font-family:Comic Sans MS;}</style>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700px" height="500px" viewbox="0 0 700 500" version="1.1"><metadata xmlns:gridsvg="http://www.stat.auckland.ac.nz/~paul/R/gridSVG/"><generator name="gridSVG" version="1.7-4" time="2022-04-20 10:25:33"></generator><argument name="name" value=""></argument><argument name="exportCoords" value="none"></argument><argument name="exportMappings" value="none"></argument><argument name="exportJS" value="none"></argument><argument name="res" value="100"></argument><argument name="prefix" value=""></argument><argument name="addClasses" value="FALSE"></argument><argument name="indent" value="TRUE"></argument><argument name="htmlWrapper" value="FALSE"></argument><argument name="usePaths" value="vpPaths"></argument><argument name="uniqueNames" value="TRUE"></argument><separator name="id.sep" value="."></separator><separator name="gPath.sep" value="::"></separator><separator name="vpPath.sep" value="::"></separator></metadata><g transform="translate(0, 500) scale(1, -1)"><g id="gridSVG" fill="rgb(255,255,255)" stroke="rgb(0,0,0)" stroke-dasharray="none" stroke-width="1.04" font-size="16.67" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" opacity="1" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><g id="layout.1"><g id="layout.2"><defs><clippath id="layout::background.1-9-12-1.1.clipPath"><rect x="100" y="0" width="500" height="500" fill="none" stroke="none"></rect></clippath></defs><g id="layout::background.1-9-12-1.1" clip-path="url(#layout::background.1-9-12-1.1.clipPath)"><g id="background.1-9-12-1.1"><rect id="background.1-9-12-1.1.1" x="100" y="0" width="500" height="500" transform="" stroke-width="1.48" stroke="rgb(255,255,255)" fill="rgb(255,255,255)" stroke-dasharray="none" stroke-opacity="1" fill-opacity="1"></rect></g></g><g id="layout::panel.7-5-7-5.1"><g id="panel.7-5-7-5.1"><g id="grill.gTree.41068.1"><g id="panel.background..rect.41064.1"><rect id="panel.background..rect.41064.1.1" x="111.42" y="11.42" width="480.97" height="480.97" transform="" stroke-width="1.48" stroke="rgb(255,255,255)" fill="rgb(255,255,255)" stroke-dasharray="none" stroke-opacity="1" fill-opacity="1"></rect></g></g><g id="GRID.polyline.41055.1"><polyline id="GRID.polyline.41055.1.1" points="409.8,328.95 415.92,337.09" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.2" points="393.22,338.97 396.76,346.44 400.3,353.9" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.3" points="398.58,293.26 403.54,297.65 408.5,302.04 413.46,306.43 418.41,310.83" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.4" points="368.38,318.77 369.97,325.19 371.55,331.61 373.13,338.03 374.71,344.45 376.29,350.86" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.5" points="354.68,320.72 354.98,328.38 355.29,336.04 355.6,343.7 355.91,351.36" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.6" points="339.68,327.1 338.49,334.45 337.29,341.8" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.7" points="324.89,323.14 321.45,332.21 318,341.28" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.8" points="360.5,254.77 371.06,258.3" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.9" points="359.75,256.43 367.07,260.66 374.39,264.89 381.71,269.11" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.10" points="292.19,189.73 291.62,189.15" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.11" points="308.12,136.46 306.24,131.5" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.12" points="327.45,101.45 326.2,93.75 324.95,86.05 323.7,78.35 322.45,70.65 321.19,62.95" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.13" points="358.04,99.6 358.42,90.08 358.81,80.56" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.14" points="295.04,161.99 288.92,152.3" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.15" points="282.35,222.27 274.33,218.85 266.32,215.44" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.16" points="289.68,208.96 285.58,206.13" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.17" points="364.9,199.18 366.68,191.96 368.46,184.74 370.23,177.53" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.18" points="424.92,187.22 425.03,187.12" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.19" points="436.38,203.13 444.06,198.69" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.20" points="444.59,220.96 447.34,220.04" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.21" points="448.91,240.12 456.62,239.19 464.33,238.25 472.05,237.31 479.76,236.38" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.22" points="398.45,153.81 401.61,147.14 404.78,140.47 407.94,133.81 411.1,127.14" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.23" points="417.13,165.1 421.39,159.43 425.66,153.75 429.93,148.07 434.19,142.39 438.46,136.71" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.24" points="337.15,275.24 333.65,280.77 330.14,286.31 326.64,291.85 323.14,297.38 319.64,302.92" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.25" points="323.42,281.56 317.66,287.55 311.91,293.54 306.15,299.53" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.26" points="290.27,294.44 289.3,295.12" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.27" points="283.01,281.25 275.81,284.32 268.61,287.39 261.41,290.46" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.28" points="280.34,266.51 276.47,267.3" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.29" points="249.59,251.9 248.12,251.9" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.30" points="251.65,231.44 245.19,230.12 238.72,228.8 232.25,227.48 225.78,226.16 219.32,224.83 212.85,223.51" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.31" points="351.9,251.9 351.9,251.9" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.32" points="351.9,251.9 354.84,255.17" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.33" points="353.27,256.07 355.57,263.07 357.87,270.07 360.17,277.07 362.46,284.07" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.34" points="373.58,277.91 378.14,283.39 382.7,288.86 387.27,294.34 391.83,299.81" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.35" points="384.17,305.27 387.68,311.09 391.2,316.91 394.72,322.74 398.24,328.56 401.76,334.38" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.36" points="349.86,285.7 349.44,292.55 349.03,299.39 348.62,306.24" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.37" points="359.55,305.8 360.57,312.95 361.58,320.09" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.38" points="337.81,304.49 335.94,311.49 334.06,318.49 332.18,325.49" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.39" points="355.91,253.7 360.17,255.62" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.40" points="351.9,251.9 344.2,248.86" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.41" points="350.75,243.7 349.81,236.98 348.87,230.25 347.93,223.53 346.99,216.81 346.05,210.09 345.11,203.37" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.42" points="316.01,218.54 311.2,214.07 306.39,209.6" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.43" points="318.03,199.81 313.66,193.08 309.29,186.35 304.92,179.63" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.44" points="319.31,172.09 316.77,165.87 314.23,159.64 311.69,153.41" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.45" points="329.57,147.89 327.78,139.54 325.99,131.19" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.46" points="344.45,128.67 344.01,121.44 343.57,114.21 343.14,106.98 342.7,99.76" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.47" points="297.47,221.92 291.58,218.68 285.68,215.43" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.48" points="377.26,209.96 380,205.43" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.49" points="392.55,215.89 401.44,208.02" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.50" points="412.25,224.74 421.06,220.78 429.88,216.81" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.51" points="421.28,201.92 431.05,194.88" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.52" points="435.32,233.12 447.23,230.43" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.53" points="386.14,195.27 389.79,189.22 393.45,183.17 397.11,177.13 400.76,171.08 404.42,165.03 408.07,158.99" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.54" points="345.46,257.11 337.94,263.18 330.43,269.26" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.55" points="325.99,261.43 321.79,262.98" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.56" points="326.45,271.43 319.28,276.93" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.57" points="315.89,271.74 309.97,275 304.06,278.26 298.14,281.52 292.22,284.77 286.31,288.03" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.58" points="319.86,253.52 313.05,253.86 306.23,254.2 299.41,254.55 292.59,254.89 285.77,255.23 278.96,255.58" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41055.1.59" points="279.23,244.56 271.95,243.82 264.67,243.09 257.39,242.35 250.1,241.62" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline></g><g id="GRID.polyline.41056.1"><polyline id="GRID.polyline.41056.1.1" points="401.76,334.38 409.8,328.95" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.2" points="401.76,334.38 393.22,338.97" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.3" points="391.83,299.81 398.58,293.26" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.4" points="361.58,320.09 368.38,318.77" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.5" points="361.58,320.09 354.68,320.72" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.6" points="332.18,325.49 339.68,327.1" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.7" points="332.18,325.49 324.89,323.14" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.8" points="360.17,255.62 360.5,254.77" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.9" points="360.17,255.62 359.75,256.43" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.10" points="304.92,179.63 298.31,184.38 292.19,189.73" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.11" points="325.99,131.19 316.96,133.49 308.12,136.46" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.12" points="342.7,99.76 335.05,100.41 327.45,101.45" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.13" points="342.7,99.76 350.37,99.48 358.04,99.6" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.14" points="311.69,153.41 303.18,157.33 295.04,161.99" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.15" points="285.68,215.43 282.35,222.27" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.16" points="285.68,215.43 289.68,208.96" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.17" points="380,205.43 372.68,201.73 364.9,199.18" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.18" points="431.05,194.88 424.92,187.22" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.19" points="431.05,194.88 436.38,203.13" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.20" points="447.23,230.43 444.59,220.96" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.21" points="447.23,230.43 448.91,240.12" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.22" points="408.07,158.99 398.45,153.81" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.23" points="408.07,158.99 417.13,165.1" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.24" points="330.43,269.26 337.15,275.24" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.25" points="319.28,276.93 323.42,281.56" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.26" points="286.31,288.03 290.27,294.44" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.27" points="286.31,288.03 283.01,281.25" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.28" points="278.96,255.58 280.34,266.51" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.29" points="250.1,241.62 249.59,251.9" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.30" points="250.1,241.62 251.65,231.44" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.31" points="351.9,251.9 351.9,251.9" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.32" points="351.9,251.9 351.9,251.9" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.33" points="354.84,255.17 353.27,256.07" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.34" points="362.46,284.07 373.58,277.91" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.35" points="391.83,299.81 384.17,305.27" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.36" points="362.46,284.07 349.86,285.7" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.37" points="348.62,306.24 359.55,305.8" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.38" points="348.62,306.24 337.81,304.49" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.39" points="354.84,255.17 355.91,253.7" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.40" points="351.9,251.9 351.9,251.9" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.41" points="344.2,248.86 350.75,243.7" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.42" points="345.11,203.37 338.56,204.75 332.27,207 326.34,210.09 320.88,213.96 316.01,218.54" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.43" points="306.39,209.6 311.91,204.34 318.03,199.81" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.44" points="304.92,179.63 311.94,175.52 319.31,172.09" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.45" points="311.69,153.41 320.51,150.26 329.57,147.89" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.46" points="325.99,131.19 335.17,129.58 344.45,128.67" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.47" points="306.39,209.6 301.55,215.49 297.47,221.92" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.48" points="345.11,203.37 351.78,202.9 358.45,203.34 365,204.68 371.31,206.9 377.26,209.96" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.49" points="380,205.43 386.67,210.19 392.55,215.89" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.50" points="401.44,208.02 405.6,213.22 409.21,218.81 412.25,224.74" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.51" points="429.88,216.81 425.95,209.15 421.28,201.92" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.52" points="429.88,216.81 433.01,224.83 435.32,233.12" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.53" points="401.44,208.02 396.78,203.26 391.66,199 386.14,195.27" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.54" points="344.2,248.86 345.46,257.11" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.55" points="330.43,269.26 325.99,261.43" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.56" points="321.79,262.98 326.45,271.43" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.57" points="319.28,276.93 315.89,271.74" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.58" points="321.79,262.98 319.86,253.52" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline><polyline id="GRID.polyline.41056.1.59" points="278.96,255.58 279.23,244.56" stroke="rgb(0,0,0)" fill="none" stroke-width="1.48" stroke-dasharray="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="1"></polyline></g><g id="GRID.text.41057.1"><g id="GRID.text.41057.1.1" transform="translate(416.49, 337.85)" stroke-width="0.1"><g id="GRID.text.41057.1.1.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.1.text" transform="rotate(-48)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.1.tspan.1" dy="5.27" x="0">t10</tspan></text></g></g><g id="GRID.text.41057.1.2" transform="translate(400.71, 354.77)" stroke-width="0.1"><g id="GRID.text.41057.1.2.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.2.text" transform="rotate(-60)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.2.tspan.1" dy="5.27" x="0">t24</tspan></text></g></g><g id="GRID.text.41057.1.3" transform="translate(419.13, 311.46)" stroke-width="0.1"><g id="GRID.text.41057.1.3.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.3.text" transform="rotate(-36)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.3.tspan.1" dy="5.27" x="0">t1</tspan></text></g></g><g id="GRID.text.41057.1.4" transform="translate(376.52, 351.79)" stroke-width="0.1"><g id="GRID.text.41057.1.4.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.4.text" transform="rotate(-72)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.4.tspan.1" dy="5.27" x="0">t27</tspan></text></g></g><g id="GRID.text.41057.1.5" transform="translate(355.95, 352.31)" stroke-width="0.1"><g id="GRID.text.41057.1.5.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.5.text" transform="rotate(-84)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.5.tspan.1" dy="5.27" x="0">t5</tspan></text></g></g><g id="GRID.text.41057.1.6" transform="translate(371.96, 258.6)" stroke-width="0.1"><g id="GRID.text.41057.1.6.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.6.text" transform="rotate(-12)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.6.tspan.1" dy="5.27" x="0">t26</tspan></text></g></g><g id="GRID.text.41057.1.7" transform="translate(382.54, 269.59)" stroke-width="0.1"><g id="GRID.text.41057.1.7.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.7.text" transform="rotate(-24)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.7.tspan.1" dy="5.27" x="0">t19</tspan></text></g></g><g id="GRID.text.41057.1.8" transform="translate(358.85, 79.61)" stroke-width="0.1"><g id="GRID.text.41057.1.8.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.8.text" transform="rotate(-276)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.8.tspan.1" dy="5.27" x="0">t25</tspan></text></g></g><g id="GRID.text.41057.1.9" transform="translate(370.46, 176.6)" stroke-width="0.1"><g id="GRID.text.41057.1.9.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.9.text" transform="rotate(-288)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.9.tspan.1" dy="5.27" x="0">t20</tspan></text></g></g><g id="GRID.text.41057.1.10" transform="translate(425.75, 186.48)" stroke-width="0.1"><g id="GRID.text.41057.1.10.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.10.text" transform="rotate(-324)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.10.tspan.1" dy="5.27" x="0">t13</tspan></text></g></g><g id="GRID.text.41057.1.11" transform="translate(444.89, 198.21)" stroke-width="0.1"><g id="GRID.text.41057.1.11.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.11.text" transform="rotate(-336)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.11.tspan.1" dy="5.27" x="0">t28</tspan></text></g></g><g id="GRID.text.41057.1.12" transform="translate(448.25, 219.74)" stroke-width="0.1"><g id="GRID.text.41057.1.12.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.12.text" transform="rotate(-348)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.12.tspan.1" dy="5.27" x="0">t23</tspan></text></g></g><g id="GRID.text.41057.1.13" transform="translate(480.71, 236.26)" stroke-width="0.1"><g id="GRID.text.41057.1.13.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.13.text" transform="rotate(-360)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.13.tspan.1" dy="5.27" x="0">t29</tspan></text></g></g><g id="GRID.text.41057.1.14" transform="translate(411.51, 126.27)" stroke-width="0.1"><g id="GRID.text.41057.1.14.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.14.text" transform="rotate(-300)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.14.tspan.1" dy="5.27" x="0">t22</tspan></text></g></g><g id="GRID.text.41057.1.15" transform="translate(439.04, 135.95)" stroke-width="0.1"><g id="GRID.text.41057.1.15.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41057.1.15.text" transform="rotate(-312)" text-anchor="start" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41057.1.15.tspan.1" dy="5.27" x="0">t17</tspan></text></g></g></g><g id="GRID.text.41058.1"><g id="GRID.text.41058.1.1" transform="translate(337.14, 342.75)" stroke-width="0.1"><g id="GRID.text.41058.1.1.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.1.text" transform="rotate(-276)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.1.tspan.1" dy="5.27" x="0">t11</tspan></text></g></g><g id="GRID.text.41058.1.2" transform="translate(317.66, 342.18)" stroke-width="0.1"><g id="GRID.text.41058.1.2.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.2.text" transform="rotate(-288)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.2.tspan.1" dy="5.27" x="0">t16</tspan></text></g></g><g id="GRID.text.41058.1.3" transform="translate(290.96, 188.46)" stroke-width="0.1"><g id="GRID.text.41058.1.3.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.3.text" transform="rotate(-408)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.3.tspan.1" dy="5.27" x="0">t12</tspan></text></g></g><g id="GRID.text.41058.1.4" transform="translate(305.9, 130.6)" stroke-width="0.1"><g id="GRID.text.41058.1.4.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.4.text" transform="rotate(-432)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.4.tspan.1" dy="5.27" x="0">t7</tspan></text></g></g><g id="GRID.text.41058.1.5" transform="translate(321.04, 62)" stroke-width="0.1"><g id="GRID.text.41058.1.5.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.5.text" transform="rotate(-444)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.5.tspan.1" dy="5.27" x="0">t21</tspan></text></g></g><g id="GRID.text.41058.1.6" transform="translate(288.41, 151.49)" stroke-width="0.1"><g id="GRID.text.41058.1.6.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.6.text" transform="rotate(-420)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.6.tspan.1" dy="5.27" x="0">t3</tspan></text></g></g><g id="GRID.text.41058.1.7" transform="translate(265.44, 215.06)" stroke-width="0.1"><g id="GRID.text.41058.1.7.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.7.text" transform="rotate(-384)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.7.tspan.1" dy="5.27" x="0">t14</tspan></text></g></g><g id="GRID.text.41058.1.8" transform="translate(284.8, 205.58)" stroke-width="0.1"><g id="GRID.text.41058.1.8.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.8.text" transform="rotate(-396)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.8.tspan.1" dy="5.27" x="0">t4</tspan></text></g></g><g id="GRID.text.41058.1.9" transform="translate(319.13, 303.73)" stroke-width="0.1"><g id="GRID.text.41058.1.9.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.9.text" transform="rotate(-300)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.9.tspan.1" dy="5.27" x="0">t15</tspan></text></g></g><g id="GRID.text.41058.1.10" transform="translate(305.49, 300.22)" stroke-width="0.1"><g id="GRID.text.41058.1.10.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.10.text" transform="rotate(-312)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.10.tspan.1" dy="5.27" x="0">t9</tspan></text></g></g><g id="GRID.text.41058.1.11" transform="translate(288.51, 295.66)" stroke-width="0.1"><g id="GRID.text.41058.1.11.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.11.text" transform="rotate(-324)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.11.tspan.1" dy="5.27" x="0">t18</tspan></text></g></g><g id="GRID.text.41058.1.12" transform="translate(260.53, 290.83)" stroke-width="0.1"><g id="GRID.text.41058.1.12.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.12.text" transform="rotate(-336)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.12.tspan.1" dy="5.27" x="0">t2</tspan></text></g></g><g id="GRID.text.41058.1.13" transform="translate(275.53, 267.49)" stroke-width="0.1"><g id="GRID.text.41058.1.13.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.13.text" transform="rotate(-348)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.13.tspan.1" dy="5.27" x="0">t30</tspan></text></g></g><g id="GRID.text.41058.1.14" transform="translate(247.16, 251.9)" stroke-width="0.1"><g id="GRID.text.41058.1.14.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.14.text" transform="rotate(-360)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.14.tspan.1" dy="5.27" x="0">t6</tspan></text></g></g><g id="GRID.text.41058.1.15" transform="translate(211.91, 223.32)" stroke-width="0.1"><g id="GRID.text.41058.1.15.scale" transform="scale(1, -1)"><text x="0" y="0" id="GRID.text.41058.1.15.text" transform="rotate(-372)" text-anchor="end" stroke="rgb(160,32,240)" font-size="15.33" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" fill="rgb(160,32,240)" stroke-opacity="1" fill-opacity="1" font-weight="normal" font-style="normal"><tspan id="GRID.text.41058.1.15.tspan.1" dy="5.27" x="0">t8</tspan></text></g></g></g><g id="GRID.gTree.41059.1"></g></g></g><g id="layout::spacer.8-6-8-6.1"></g><g id="layout::spacer.8-4-8-4.1"></g><g id="layout::spacer.6-6-6-6.1"></g><g id="layout::spacer.6-4-6-4.1"></g><g id="layout::axis-t.6-5-6-5.1"></g><g id="layout::axis-l.7-4-7-4.1"><g id="layout::axis-l.7-4-7-4::GRID.VP.4904.1"><g id="axis-l.7-4-7-4.1"><g id="layout::axis-l.7-4-7-4::GRID.VP.4904::axis.1"><g id="axis.1"><g id="layout::axis-l.7-4-7-4::GRID.VP.4904::axis::axis.1-1-1-1.1"></g><g id="layout::axis-l.7-4-7-4::GRID.VP.4904::axis::axis.1-2-1-2.1"></g></g></g></g></g></g><g id="layout::axis-r.7-6-7-6.1"></g><g id="layout::axis-b.8-5-8-5.1"><g id="layout::axis-b.8-5-8-5::GRID.VP.4903.1"><g id="axis-b.8-5-8-5.1"><g id="layout::axis-b.8-5-8-5::GRID.VP.4903::axis.1"><g id="axis.2"><g id="layout::axis-b.8-5-8-5::GRID.VP.4903::axis::axis.1-1-1-1.1"></g><g id="layout::axis-b.8-5-8-5::GRID.VP.4903::axis::axis.2-1-2-1.1"></g></g></g></g></g></g><g id="layout::xlab-t.5-5-5-5.1"></g><g id="layout::xlab-b.9-5-9-5.1"></g><g id="layout::ylab-l.7-3-7-3.1"></g><g id="layout::ylab-r.7-7-7-7.1"></g><g id="layout::subtitle.4-5-4-5.1"></g><g id="layout::title.3-5-3-5.1"></g><g id="layout::caption.10-5-10-5.1"></g><g id="layout::tag.2-2-2-2.1"></g></g></g></g></g></svg><div id="htmlwidget-f599c226fc4543a678a5" style="width:0px;height:0px;" class="comicR html-widget"></div>
<script type="application/json" data-for="htmlwidget-f599c226fc4543a678a5">{"x":{"selector":"#ggtree_comic","options":{"ff":5}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="ascii-tree" class="section level2" number="15.5">
<h2>
<span class="header-section-number">B.5</span> Print ASCII-art Rooted Tree<a class="anchor" aria-label="anchor" href="#ascii-tree"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb303"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/gluc/data.tree">data.tree</a></span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html">rtree</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/data.tree/man/as.Node.html">as.Node</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/print-methods.html">names</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/print-methods.html">print</a></span><span class="op">(</span><span class="va">d</span>, row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>                       
 11                    
  ¦--12                
  ¦   ¦--13            
  ¦   ¦   ¦--t4        
  ¦   ¦   °--t7        
  ¦   °--14            
  ¦       ¦--15        
  ¦       ¦   ¦--t1    
  ¦       ¦   °--16    
  ¦       ¦       ¦--t6
  ¦       ¦       °--t5
  ¦       °--t8        
  °--17                
      ¦--t3            
      °--18            
          ¦--19        
          ¦   ¦--t10   
          ¦   °--t9    
          °--t2        </code></pre>
<p>It is neat to print ASCII-art of the phylogeny. Sometimes, we don’t want to plot the tree, but just take a glance at the tree structure without leaving the focus from the R console. However, it is not a good idea to print the whole tree as ASCII text if the tree is large. Sometimes, we just want to look at a specific portion of the tree and its immediate relatives. In this scenario, we can use <code><a href="https://docs.ropensci.org/treeio/reference/tree_subset.html">treeio::tree_subset()</a></code> function (see <a href="subsetting-tree-with-data">session 2.4</a>) to extract selected portion of a tree. Then we can print ASCII-art of the tree subset to explore the evolutionary relationship of the species of our interest in the R console.</p>
<p>The <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> supports parsing tip labels as emoji to create <a href="chapter8.html#phylomoji">phylomoji</a>. With the <a href="https://CRAN.R-project.org/package=data.tree"><strong>data.tree</strong></a> and <a href="https://CRAN.R-project.org/package=emojifont"><strong>emojifont</strong></a> packages, we can also print phylomoji as ASCII text (Figure <a href="related-tools.html#fig:emojidatatree">B.4</a>).</p>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/gluc/data.tree">data.tree</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/GuangchuangYu/emojifont">emojifont</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">tt</span> <span class="op">&lt;-</span> <span class="st">'((snail,mushroom),(((sunflower,evergreen_tree),leaves),green_salad));'</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">tt</span><span class="op">)</span></span>
<span><span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emojifont/man/emoji.html">emoji</a></span><span class="op">(</span><span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/data.tree/man/as.Node.html">as.Node</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/print-methods.html">names</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/print-methods.html">print</a></span><span class="op">(</span><span class="va">d</span>, row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:emojidatatree"></span>
<img src="img/data-tree-emojim.png" alt="Print phylomoji as ASCII text." width="100%"><p class="caption">
FIGURE B.4: <strong>Print phylomoji as ASCII text.</strong>
</p>
</div>
<p>Another way to print ASCII-art of phylogeny is to use the <code><a href="https://rdrr.io/pkg/devout/man/ascii.html">ascii()</a></code> device defined in the <a href="https://github.com/coolbutuseless/devout"><strong>devout</strong></a> package. Here is an example:</p>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">devout</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/devout/man/ascii.html">ascii</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">80</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html">rtree</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/gridSVG/man/gridsvg.html">dev.off</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>                                                                                
                             #########################                          
                             #                                                  
                            ##                                                  
                            ##                                                  
                            #####################                               
   ##########################                                                   
   #                        #                                                   
   #                        #                                                   
   #                        ##########                                          
   #                                                                            
   #                                                                            
   #                                                                            
   #                                   ###############                          
   #                                   #                                        
   #####################################                                        
                                       #                                        
                                       #####################################    
                                                                                
                                                                                 </code></pre>
</div>
<div id="facet-zoom" class="section level2" number="15.6">
<h2>
<span class="header-section-number">B.6</span> Zoom in on the Selected Portion<a class="anchor" aria-label="anchor" href="#facet-zoom"><i class="fas fa-link"></i></a>
</h2>
<p>In addition to using <code><a href="https://rdrr.io/pkg/ggtree/man/viewClade.html">viewClade()</a></code> function, users can use the <a href="https://CRAN.R-project.org/package=ggforce"><strong>ggforce</strong></a> package to zoom in on a selected clade (Figure <a href="related-tools.html#fig:facetZoom">B.5</a>).</p>


<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2019</span><span class="op">-</span><span class="fl">08</span><span class="op">-</span><span class="fl">05</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html">rtree</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu">tidytree</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tidytree/man/offspring.html">offspring</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">43</span>, self_include<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggforce</span><span class="fu">::</span><span class="fu"><a href="https://ggforce.data-imaginist.com/reference/facet_zoom.html">facet_zoom</a></span><span class="op">(</span>xy <span class="op">=</span> <span class="va">node</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html">%in%</a></span> <span class="va">nn</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:facetZoom"></span>
<img src="treedata_files/figure-html/facetZoom-1.svg" alt="Zoom in on a selected clade." width="98%"><p class="caption">
FIGURE B.5: <strong>Zoom in on a selected clade.</strong>
</p>
</div>
</div>
<div id="ggimage-tips" class="section level2" number="15.7">
<h2>
<span class="header-section-number">B.7</span> Tips for Using <code>ggtree</code> with <code>ggimage</code><a class="anchor" aria-label="anchor" href="#ggimage-tips"><i class="fas fa-link"></i></a>
</h2>
<p>The <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> supports annotating a tree with silhouette images via the <a href="https://CRAN.R-project.org/package=ggimage"><strong>ggimage</strong></a> package. The <a href="https://CRAN.R-project.org/package=ggimage"><strong>ggimage</strong></a> provides the grammar of graphic syntax to work with image files. It allows processing images on the fly via the <code>image_fun</code> parameter, which accepts a function to process <code>magick-image</code> objects (Figure <a href="related-tools.html#fig:ggimagebg">B.6</a>). The <a href="https://CRAN.R-project.org/package=magick"><strong>magick</strong></a> package provides several functions, and these functions can be combined to perform a particular task.</p>
<div id="ggimage-rm-image-bg" class="section level3" number="15.7.1">
<h3>
<span class="header-section-number">B.7.1</span> Example 1: Remove background of images<a class="anchor" aria-label="anchor" href="#ggimage-rm-image-bg"><i class="fas fa-link"></i></a>
</h3>


<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/GuangchuangYu/ggimage">ggimage</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">imgdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/frogs"</span>, package <span class="op">=</span> <span class="st">"TDbook"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1982</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html">rtree</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_grey</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_nodelab.html">geom_nodelab</a></span><span class="op">(</span>image<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">imgdir</span>, <span class="st">"/frog.jpg"</span><span class="op">)</span>, </span>
<span>                        geom<span class="op">=</span><span class="st">"image"</span>, size<span class="op">=</span><span class="fl">.12</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"original image"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_nodelab.html">geom_nodelab</a></span><span class="op">(</span>image<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">imgdir</span>, <span class="st">"/frog.jpg"</span><span class="op">)</span>, </span>
<span>            geom<span class="op">=</span><span class="st">"image"</span>, size<span class="op">=</span><span class="fl">.12</span>,</span>
<span>            image_fun<span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/color.html">image_transparent</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"white"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"image with background removed"</span><span class="op">)</span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ggimagebg"></span>
<img src="treedata_files/figure-html/ggimagebg-1.svg" alt="Remove image background. Plotting silhouette images on a phylogenetic tree with background not removed (A) and removed (B)." width="100%"><p class="caption">
FIGURE B.6: <strong>Remove image background.</strong> Plotting silhouette images on a phylogenetic tree with background not removed (A) and removed (B).
</p>
</div>
</div>
<div id="ggimage-bgimage" class="section level3" number="15.7.2">
<h3>
<span class="header-section-number">B.7.2</span> Example 2: Plot tree on a background image<a class="anchor" aria-label="anchor" href="#ggimage-bgimage"><i class="fas fa-link"></i></a>
</h3>
<p>The <code><a href="https://rdrr.io/pkg/ggimage/man/geom_bgimage.html">geom_bgimage()</a></code> adds a layer of the image and puts the layer to the bottom of the layer stack. It is a normal layer and doesn’t change the structure of the output <code>ggtree</code> object. Users can add annotation layers without the background image layer (Figure <a href="related-tools.html#fig:bgimage">B.7</a>).</p>


<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html">rtree</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">1.5</span>, color<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggimage/man/geom_bgimage.html">geom_bgimage</a></span><span class="op">(</span><span class="st">'img/blackboard.jpg'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tiplab.html">geom_tiplab</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"white"</span>, size<span class="op">=</span><span class="fl">5</span>, family<span class="op">=</span><span class="st">'xkcd'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:bgimage"></span>
<img src="treedata_files/figure-html/bgimage-1.png" alt="Use an image file as a tree background." width="98%"><p class="caption">
FIGURE B.7: <strong>Use an image file as a tree background.</strong>
</p>
</div>
</div>
</div>
<div id="run-ggtree-in-jupyter-notebook" class="section level2" number="15.8">
<h2>
<span class="header-section-number">B.8</span> Run ggtree in Jupyter Notebook<a class="anchor" aria-label="anchor" href="#run-ggtree-in-jupyter-notebook"><i class="fas fa-link"></i></a>
</h2>
<p>If you have <a href="https://jupyter.org/">Jupyter notebook</a> installed on your system, you can install <a href="https://irkernel.github.io/">IRkernel</a> with the following command in R:</p>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"IRkernel"</span><span class="op">)</span></span>
<span><span class="fu">IRkernel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IRkernel/man/installspec.html">installspec</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Then you can use <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> and other R packages in the Jupyter notebook (Figure <a href="related-tools.html#fig:jupyter">B.8</a>). Here is a screenshot of recreating Figure <a href="chapter8.html#fig:phylomoji1">8.5</a> in the Jupyter notebook.</p>


<div class="figure">
<span style="display:block;" id="fig:jupyter"></span>
<img src="img/Screenshot_2019-06-24_ggtree-jupyter.png" alt="ggtree in Jupyter notebook. Running ggtree in Jupyter notebook via R kernel." width="100%"><p class="caption">
FIGURE B.8: <strong>ggtree in Jupyter notebook.</strong> Running ggtree in Jupyter notebook via R kernel.
</p>
</div>

<div style="page-break-after: always;"></div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="faq.html"><span class="header-section-number">A</span> Frequently Asked Questions</a></div>
<div class="next"><a href="figures-and-tables.html"><span class="header-section-number">C</span> Figures and Tables</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#related-tools"><span class="header-section-number">B</span> Related Tools</a></li>
<li><a class="nav-link" href="#MicrobiotaProcess-taxonomy"><span class="header-section-number">B.1</span> MicrobiotaProcess: Convert Taxonomy Table to a treedata Object</a></li>
<li><a class="nav-link" href="#rtol"><span class="header-section-number">B.2</span> rtol: An R Interface to Open Tree API</a></li>
<li><a class="nav-link" href="#plotly"><span class="header-section-number">B.3</span> Convert a ggtree object to a plotly object</a></li>
<li><a class="nav-link" href="#commicR"><span class="header-section-number">B.4</span> Comic (xkcd-like) phylogenetic tree</a></li>
<li><a class="nav-link" href="#ascii-tree"><span class="header-section-number">B.5</span> Print ASCII-art Rooted Tree</a></li>
<li><a class="nav-link" href="#facet-zoom"><span class="header-section-number">B.6</span> Zoom in on the Selected Portion</a></li>
<li>
<a class="nav-link" href="#ggimage-tips"><span class="header-section-number">B.7</span> Tips for Using ggtree with ggimage</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ggimage-rm-image-bg"><span class="header-section-number">B.7.1</span> Example 1: Remove background of images</a></li>
<li><a class="nav-link" href="#ggimage-bgimage"><span class="header-section-number">B.7.2</span> Example 2: Plot tree on a background image</a></li>
</ul>
</li>
<li><a class="nav-link" href="#run-ggtree-in-jupyter-notebook"><span class="header-section-number">B.8</span> Run ggtree in Jupyter Notebook</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Integration, Manipulation and Visualization of Phylogenetic Trees</strong>" was written by Guangchuang Yu. It was last built on 2022-07-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
