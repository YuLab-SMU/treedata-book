<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Visual Exploration of Phylogenetic Trees | Data Integration, Manipulation and Visualization of Phylogenetic Trees</title>
<meta name="author" content="Guangchuang Yu">
<meta name="description" content="The ggtree (Yu et al., 2017) supports many ways of manipulating the tree visually, including viewing selected clade to explore large tree (Figure 6.1), taxa clustering (Figure 6.5), rotating clade...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 6 Visual Exploration of Phylogenetic Trees | Data Integration, Manipulation and Visualization of Phylogenetic Trees">
<meta property="og:type" content="book">
<meta property="og:image" content="/book-cover.png">
<meta property="og:description" content="The ggtree (Yu et al., 2017) supports many ways of manipulating the tree visually, including viewing selected clade to explore large tree (Figure 6.1), taxa clustering (Figure 6.5), rotating clade...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Visual Exploration of Phylogenetic Trees | Data Integration, Manipulation and Visualization of Phylogenetic Trees">
<meta name="twitter:description" content="The ggtree (Yu et al., 2017) supports many ways of manipulating the tree visually, including viewing selected clade to explore large tree (Figure 6.1), taxa clustering (Figure 6.5), rotating clade...">
<meta name="twitter:image" content="/book-cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap/bootstrap.bundle.min.js"></script><script src="libs/bs3compat/transition.js"></script><script src="libs/bs3compat/tabs.js"></script><script src="libs/bs3compat/bs3compat.js"></script><link href="libs/bs4_book/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book/bs4_book.js"></script><script src="libs/kePrint/kePrint.js"></script><link href="libs/lightable/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets/htmlwidgets.js"></script><script src="libs/pathseg/pathseg.js"></script><script src="libs/comic/comic.min.js"></script><script src="libs/comicR-binding/comicR.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Integration, Manipulation and Visualization of Phylogenetic Trees</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="author.html">About the Author</a></li>
<li class="book-part">Part I: Tree data input, output, and manipulation</li>
<li><a class="" href="chapter1.html"><span class="header-section-number">1</span> Importing Tree with Data</a></li>
<li><a class="" href="chapter2.html"><span class="header-section-number">2</span> Manipulating Tree with Data</a></li>
<li><a class="" href="chapter3.html"><span class="header-section-number">3</span> Exporting tree with data</a></li>
<li class="book-part">Part II: Tree data visualization and annotation</li>
<li><a class="" href="chapter4.html"><span class="header-section-number">4</span> Phylogenetic Tree Visualization</a></li>
<li><a class="" href="chapter5.html"><span class="header-section-number">5</span> Phylogenetic Tree Annotation</a></li>
<li><a class="active" href="chapter6.html"><span class="header-section-number">6</span> Visual Exploration of Phylogenetic Trees</a></li>
<li><a class="" href="chapter7.html"><span class="header-section-number">7</span> Plotting tree with data</a></li>
<li><a class="" href="chapter8.html"><span class="header-section-number">8</span> Annotating Tree with Silhouette Images and Sub-plots</a></li>
<li><a class="" href="chapter9.html"><span class="header-section-number">9</span> ggtree for Other Tree-like Objects</a></li>
<li class="book-part">Part III: ggtree extensions</li>
<li><a class="" href="chapter10.html"><span class="header-section-number">10</span> ggtreeExtra for Presenting Data on a Circular Layout</a></li>
<li><a class="" href="chapter11.html"><span class="header-section-number">11</span> Other ggtree Extensions</a></li>
<li class="book-part">Part IV: Miscellaneous topics</li>
<li><a class="" href="chapter12.html"><span class="header-section-number">12</span> ggtree Utilities</a></li>
<li><a class="" href="chapter13.html"><span class="header-section-number">13</span> Gallery of Reproducible Examples</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="faq.html"><span class="header-section-number">A</span> Frequently Asked Questions</a></li>
<li><a class="" href="related-tools.html"><span class="header-section-number">B</span> Related Tools</a></li>
<li><a class="" href="figures-and-tables.html"><span class="header-section-number">C</span> Figures and Tables</a></li>
<li><a class="" href="publications-of-the-ggtree-package-suite.html"><span class="header-section-number">D</span> Publications of the ggtree Package Suite</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chapter6" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Visual Exploration of Phylogenetic Trees<a class="anchor" aria-label="anchor" href="#chapter6"><i class="fas fa-link"></i></a>
</h1>
<p>The <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> <span class="citation">(<a href="references.html#ref-yu_ggtree:_2017" role="doc-biblioref">Yu et al., 2017</a>)</span> supports many ways of manipulating the tree visually, including viewing selected clade to explore large tree (Figure <a href="chapter6.html#fig:viewClade">6.1</a>), taxa clustering (Figure <a href="chapter6.html#fig:groupOTU">6.5</a>), rotating clade or tree (Figure <a href="chapter6.html#fig:rfClade">6.6</a>B and <a href="chapter6.html#fig:rotateTree">6.8</a>), zoom out or collapsing clades (Figure <a href="chapter6.html#fig:collapseExpand">6.3</a>A and <a href="chapter6.html#fig:scaleClade">6.2</a>), <em>etc.</em>. Details of the tree manipulation functions are summarized in Table <a href="chapter6.html#tab:treeman">6.1</a>.</p>
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:treeman">TABLE 6.1: </span>Tree manipulation functions.
</caption>
<thead><tr>
<th style="text-align:left;">
Function
</th>
<th style="text-align:left;">
Description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
collapse
</td>
<td style="text-align:left;">
Collapse a selecting clade
</td>
</tr>
<tr>
<td style="text-align:left;">
expand
</td>
<td style="text-align:left;">
Expand collapsed clade
</td>
</tr>
<tr>
<td style="text-align:left;">
flip
</td>
<td style="text-align:left;">
Exchange position of 2 clades that share a parent node
</td>
</tr>
<tr>
<td style="text-align:left;">
groupClade
</td>
<td style="text-align:left;">
Grouping clades
</td>
</tr>
<tr>
<td style="text-align:left;">
groupOTU
</td>
<td style="text-align:left;">
Grouping OTUs by tracing back to the most recent common ancestor
</td>
</tr>
<tr>
<td style="text-align:left;">
identify
</td>
<td style="text-align:left;">
Interactive tree manipulation
</td>
</tr>
<tr>
<td style="text-align:left;">
rotate
</td>
<td style="text-align:left;">
Rotating a selected clade by 180 degrees
</td>
</tr>
<tr>
<td style="text-align:left;">
rotate_tree
</td>
<td style="text-align:left;">
Rotating circular layout tree by a specific angle
</td>
</tr>
<tr>
<td style="text-align:left;">
scaleClade
</td>
<td style="text-align:left;">
Zoom in or zoom out selecting clade
</td>
</tr>
<tr>
<td style="text-align:left;">
open_tree
</td>
<td style="text-align:left;">
Convert a tree to fan layout by specific open angle
</td>
</tr>
</tbody>
</table></div>
<div id="viewing-selected-clade" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Viewing Selected Clade<a class="anchor" aria-label="anchor" href="#viewing-selected-clade"><i class="fas fa-link"></i></a>
</h2>
<p>A clade is a monophyletic group that contains a single ancestor and all of its descendants. We can visualize a specifically selected clade via the <code><a href="https://rdrr.io/pkg/ggtree/man/viewClade.html">viewClade()</a></code> function as demonstrated in Figure <a href="chapter6.html#fig:viewClade">6.1</a>B. Another solution is to extract the selected clade as a new tree object as described in <a href="chapter2.html#subsetting-tree-with-data">session 2.5</a>. These functions are developed to help users explore a large tree.</p>


<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/treedata-book/">ggtree</a></span><span class="op">)</span></span>
<span><span class="va">nwk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sample.nwk"</span>, package<span class="op">=</span><span class="st">"treeio"</span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span><span class="op">(</span><span class="va">nwk</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tiplab.html">geom_tiplab</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/viewClade.html">viewClade</a></span><span class="op">(</span><span class="va">p</span>, <span class="fu"><a href="https://rdrr.io/pkg/tidytree/man/MRCA.html">MRCA</a></span><span class="op">(</span><span class="va">p</span>, <span class="st">"I"</span>, <span class="st">"L"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:viewClade"></span>
<img src="treedata_files/figure-html/viewClade-1.svg" alt="Viewing a selected clade of a tree. An example tree used to demonstrate how ggtree supports exploring or manipulating phylogenetic tree visually (A). The ggtree supports visualizing selected clade (B). A clade can be selected by specifying a node number or determined by the most recent common ancestor of selected tips." width="100%"><p class="caption">
FIGURE 6.1: <strong>Viewing a selected clade of a tree.</strong> An example tree used to demonstrate how <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> supports exploring or manipulating phylogenetic tree visually (A). The <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> supports visualizing selected clade (B). A clade can be selected by specifying a node number or determined by the most recent common ancestor of selected tips.
</p>
</div>
<p>Some of the functions, <em>e.g.</em>, <code><a href="https://rdrr.io/pkg/ggtree/man/viewClade.html">viewClade()</a></code>, work with clade and accept a parameter of an internal node number. To get the internal node number, users can use the <code><a href="https://rdrr.io/pkg/tidytree/man/MRCA.html">MRCA()</a></code> function (as in Figure <a href="chapter6.html#fig:viewClade">6.1</a>) by providing two taxa names. The function will return the node number of input taxa’s most recent common ancestor (MRCA). It works with a tree and graphic (<em>i.e.</em>, the <code><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree()</a></code> output) object. The <a href="https://CRAN.R-project.org/package=tidytree"><strong>tidytree</strong></a> package also provides an <code><a href="https://rdrr.io/pkg/tidytree/man/MRCA.html">MRCA()</a></code> method to extract information from the MRCA node (see details in <a href="chapter2.html#accesor-tidytree">session 2.1.3</a>).</p>
</div>
<div id="scale-clade" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Scaling Selected Clade<a class="anchor" aria-label="anchor" href="#scale-clade"><i class="fas fa-link"></i></a>
</h2>
<p>The <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> provides another option to zoom out (or compress) selected clades via the <code><a href="https://rdrr.io/pkg/ggtree/man/scaleClade.html">scaleClade()</a></code> function. In this way, we retain the topology and branch lengths of compressed clades. This helps to save the space to highlight those clades of primary interest in the study.</p>


<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tidytree/man/groupClade.html">groupClade</a></span><span class="op">(</span><span class="va">tree</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">17</span>, <span class="fl">21</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">tree2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">'none'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"firebrick"</span>, <span class="st">"steelblue"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/scaleClade.html">scaleClade</a></span><span class="op">(</span><span class="va">p</span>, node<span class="op">=</span><span class="fl">17</span>, scale<span class="op">=</span><span class="fl">.1</span><span class="op">)</span> </span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:scaleClade"></span>
<img src="treedata_files/figure-html/scaleClade-1.svg" alt="Scaling selected clade. Clades can be zoomed in (if scale &gt; 1) to highlight or zoomed out to save space." width="100%"><p class="caption">
FIGURE 6.2: <strong>Scaling selected clade.</strong> Clades can be zoomed in (if <code>scale &gt; 1</code>) to highlight or zoomed out to save space.
</p>
</div>
<p>If users want to emphasize important clades, they can use the <code><a href="https://rdrr.io/pkg/ggtree/man/scaleClade.html">scaleClade()</a></code> function by passing a numeric value larger than 1 to the <code>scale</code> parameter. Then the selected clade will be zoomed in. Users can also use the <code><a href="https://rdrr.io/pkg/tidytree/man/groupClade.html">groupClade()</a></code> function to assign selected clades with different clade IDs which can be used to color these clades with different colors as shown in Figure <a href="chapter6.html#fig:scaleClade">6.2</a>.</p>
</div>
<div id="collapsing-and-expanding-clade" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Collapsing and Expanding Clade<a class="anchor" aria-label="anchor" href="#collapsing-and-expanding-clade"><i class="fas fa-link"></i></a>
</h2>
<p>It is a common practice to prune or collapse clades so that certain aspects of a tree can be emphasized. The <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> supports collapsing selected clades using the <code><a href="https://dplyr.tidyverse.org/reference/compute.html">collapse()</a></code> function as shown in Figure <a href="chapter6.html#fig:collapseExpand">6.3</a>A.</p>


<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collapse</a></span><span class="op">(</span>node<span class="op">=</span><span class="fl">21</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_point2.html">geom_point2</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>subset<span class="op">=</span><span class="op">(</span><span class="va">node</span><span class="op">==</span><span class="fl">21</span><span class="op">)</span><span class="op">)</span>, shape<span class="op">=</span><span class="fl">21</span>, size<span class="op">=</span><span class="fl">5</span>, fill<span class="op">=</span><span class="st">'green'</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collapse</a></span><span class="op">(</span><span class="va">p2</span>, node<span class="op">=</span><span class="fl">23</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_point2.html">geom_point2</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>subset<span class="op">=</span><span class="op">(</span><span class="va">node</span><span class="op">==</span><span class="fl">23</span><span class="op">)</span><span class="op">)</span>, shape<span class="op">=</span><span class="fl">23</span>, size<span class="op">=</span><span class="fl">5</span>, fill<span class="op">=</span><span class="st">'red'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/expand.html">expand</a></span><span class="op">(</span><span class="va">p2</span>, node<span class="op">=</span><span class="fl">23</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/expand.html">expand</a></span><span class="op">(</span>node<span class="op">=</span><span class="fl">21</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:collapseExpand"></span>
<img src="treedata_files/figure-html/collapseExpand-1.svg" alt="Collapsing selected clades and expanding collapsed clades. Clades can be selected to collapse (A) and the collapsed clades can be expanded back (B) if necessary as ggtree stored all information of species relationships. Green and red symbols were displayed on the tree to indicate the collapsed clades." width="100%"><p class="caption">
FIGURE 6.3: <strong>Collapsing selected clades and expanding collapsed clades.</strong> Clades can be selected to collapse (A) and the collapsed clades can be expanded back (B) if necessary as <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> stored all information of species relationships. Green and red symbols were displayed on the tree to indicate the collapsed clades.
</p>
</div>
<p>Here two clades were collapsed and labeled by the green circle and red square symbolic points. Collapsing is a common strategy to collapse clades that are too large for displaying in full or are not the primary interest of the study. In <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a>, we can expand (<em>i.e.</em>, uncollapse) the collapsed branches back with the <code><a href="https://rdrr.io/pkg/ggtree/man/expand.html">expand()</a></code> function to show details of species relationships as demonstrated in Figure <a href="chapter6.html#fig:collapseExpand">6.3</a>B.</p>
<p>Triangles are often used to represent the collapsed clade and <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> also supports it. The <code><a href="https://dplyr.tidyverse.org/reference/compute.html">collapse()</a></code> function provides a “mode” parameter, which by default is “none” and the selected clade was collapsed as a “tip”. Users can specify the <code>mode</code> to “max” that uses the farthest tip (Figure <a href="chapter6.html#fig:collapseMode">6.4</a>A), “min” that uses the closest tip (Figure <a href="chapter6.html#fig:collapseMode">6.4</a>B), and “mixed” that uses both (Figure <a href="chapter6.html#fig:collapseMode">6.4</a>C).</p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tiplab.html">geom_tiplab</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">node</span> <span class="op">&lt;-</span> <span class="fl">21</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collapse</a></span><span class="op">(</span><span class="va">p2</span>, <span class="va">node</span>, <span class="st">'max'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/expand.html">expand</a></span><span class="op">(</span><span class="va">node</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collapse</a></span><span class="op">(</span><span class="va">p2</span>, <span class="va">node</span>, <span class="st">'min'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/expand.html">expand</a></span><span class="op">(</span><span class="va">node</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collapse</a></span><span class="op">(</span><span class="va">p2</span>, <span class="va">node</span>, <span class="st">'mixed'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/expand.html">expand</a></span><span class="op">(</span><span class="va">node</span><span class="op">)</span></span></code></pre></div>
<p>We can pass additional parameters to set the color and transparency of the triangles (Figure <a href="chapter6.html#fig:collapseMode">6.4</a>D).</p>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collapse</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">21</span>, <span class="st">'mixed'</span>, fill<span class="op">=</span><span class="st">'steelblue'</span>, alpha<span class="op">=</span><span class="fl">.4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collapse</a></span><span class="op">(</span><span class="fl">23</span>, <span class="st">'mixed'</span>, fill<span class="op">=</span><span class="st">'firebrick'</span>, color<span class="op">=</span><span class="st">'blue'</span><span class="op">)</span></span></code></pre></div>
<p>We can combine <a href="chapter6.html#scale-clade">scaleClade</a> with <code>collapse</code> to zoom in/out of the triangles (Figure <a href="chapter6.html#fig:collapseMode">6.4</a>E).</p>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/scaleClade.html">scaleClade</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">23</span>, <span class="fl">.2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collapse</a></span><span class="op">(</span><span class="fl">23</span>, <span class="st">'min'</span>, fill<span class="op">=</span><span class="st">"darkgreen"</span><span class="op">)</span>  </span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:collapseMode"></span>
<img src="treedata_files/figure-html/collapseMode-1.svg" alt="Collapse clade as a triangle. ‘max’ takes the position of most distant tip (A). ‘min’ takes the position of closest tip (B). ‘mixed’ takes the positions of both closest and distant tips (C), which looks more like the shape of the clade. Set color, fill, and alpha of the triangles (D). Combine with scaleClade to zoom out the triangle to save space (E)." width="100%"><p class="caption">
FIGURE 6.4: <strong>Collapse clade as a triangle.</strong> ‘max’ takes the position of most distant tip (A). ‘min’ takes the position of closest tip (B). ‘mixed’ takes the positions of both closest and distant tips (C), which looks more like the shape of the clade. Set color, fill, and alpha of the triangles (D). Combine with <code>scaleClade</code> to zoom out the triangle to save space (E).
</p>
</div>
</div>
<div id="group-taxa-vis" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Grouping Taxa<a class="anchor" aria-label="anchor" href="#group-taxa-vis"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://rdrr.io/pkg/tidytree/man/groupClade.html">groupClade()</a></code> function assigns the branches and nodes under different clades into different groups. It accepts an internal node or a vector of internal nodes to cluster clade/clades.</p>
<p>Similarly, the <code><a href="https://rdrr.io/pkg/tidytree/man/groupOTU.html">groupOTU()</a></code> function assigns branches and nodes to different groups based on user-specified groups of operational taxonomic units (OTUs) that are not necessarily within a clade but can be monophyletic (clade), polyphyletic or paraphyletic. It accepts a vector of OTUs (taxa name) or a list of OTUs and will trace back from OTUs to their most recent common ancestor (MRCA) and cluster them together as demonstrated in Figure <a href="chapter6.html#fig:groupOTU">6.5</a>.</p>
<p>A phylogenetic tree can be annotated by mapping different line types, sizes, colors, or shapes of the branches or nodes that have been assigned to different groups.</p>


<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">rn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span>, <span class="st">"_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">150</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">rn</span></span>
<span><span class="va">d_iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"man"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tree_iris</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/bionj.html">bionj</a></span><span class="op">(</span><span class="va">d_iris</span><span class="op">)</span></span>
<span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>setosa     <span class="op">=</span> <span class="va">rn</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span>,</span>
<span>            versicolor <span class="op">=</span> <span class="va">rn</span><span class="op">[</span><span class="fl">51</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span>,</span>
<span>            virginica  <span class="op">=</span> <span class="va">rn</span><span class="op">[</span><span class="fl">101</span><span class="op">:</span><span class="fl">150</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">tree_iris</span>, layout <span class="op">=</span> <span class="st">'circular'</span>, branch.length<span class="op">=</span><span class="st">'none'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tidytree/man/groupOTU.html">groupOTU</a></span><span class="op">(</span><span class="va">p_iris</span>, <span class="va">grp</span>, <span class="st">'Species'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">Species</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:groupOTU"></span>
<img src="treedata_files/figure-html/groupOTU-1.svg" alt="Grouping OTUs. OTU clustering based on their relationships. Selected OTUs and their ancestors up to the MRCA will be clustered together." width="100%"><p class="caption">
FIGURE 6.5: <strong>Grouping OTUs.</strong> OTU clustering based on their relationships. Selected OTUs and their ancestors up to the MRCA will be clustered together.
</p>
</div>
<p>We can group taxa at the tree level. The following code will produce an identical figure of Figure <a href="chapter6.html#fig:groupOTU">6.5</a> (see more details described in <a href="chapter2.html#grouping-taxa">session 2.2.3</a>).</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tidytree/man/groupOTU.html">groupOTU</a></span><span class="op">(</span><span class="va">tree_iris</span>, <span class="va">grp</span>, <span class="st">"Species"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">tree_iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">Species</span><span class="op">)</span>, layout <span class="op">=</span> <span class="st">'circular'</span>, </span>
<span>        branch.length <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="exploring-tree-structure" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Exploring Tree Structure<a class="anchor" aria-label="anchor" href="#exploring-tree-structure"><i class="fas fa-link"></i></a>
</h2>
<p>To facilitate exploring the tree structure, <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> supports rotating selected clade by 180 degrees using the <code><a href="https://rdrr.io/pkg/ggtree/man/rotate.html">rotate()</a></code> function (Figure <a href="chapter6.html#fig:rfClade">6.6</a>B). Position of immediate descendant clades of the internal node can be exchanged via <code><a href="https://rdrr.io/pkg/ggtree/man/flip.html">flip()</a></code> function (Figure <a href="chapter6.html#fig:rfClade">6.6</a>C).</p>


<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_point2.html">geom_point2</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>subset<span class="op">=</span><span class="va">node</span><span class="op">==</span><span class="fl">16</span><span class="op">)</span>, color<span class="op">=</span><span class="st">'darkgreen'</span>, size<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/rotate.html">rotate</a></span><span class="op">(</span><span class="va">p1</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/flip.html">flip</a></span><span class="op">(</span><span class="va">p2</span>, <span class="fl">17</span>, <span class="fl">21</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:rfClade"></span>
<img src="treedata_files/figure-html/rfClade-1.svg" alt="Exploring tree structure. A clade (indicated by a dark green circle) in a tree (A) can be rotated by 180° (B) and the positions of its immediate descendant clades (colored by blue and red) can be exchanged (C)." width="100%"><p class="caption">
FIGURE 6.6: <strong>Exploring tree structure.</strong> A clade (indicated by a dark green circle) in a tree (A) can be rotated by 180° (B) and the positions of its immediate descendant clades (colored by blue and red) can be exchanged (C).
</p>
</div>
<p>Most of the tree manipulation functions are working on clades, while <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> also provides functions to manipulate a tree, including <code><a href="https://rdrr.io/pkg/ggtree/man/open_tree.html">open_tree()</a></code> to transform a tree in either rectangular or circular layout to the fan layout, and <code><a href="https://rdrr.io/pkg/ggtree/man/rotate_tree.html">rotate_tree()</a></code> function to rotate a tree for specific angle in both circular or fan layouts, as demonstrated in Figures <a href="chapter6.html#fig:openTree">6.7</a> and <a href="chapter6.html#fig:rotateTree">6.8</a>.</p>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/open_tree.html">open_tree</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">180</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tiplab.html">geom_tiplab</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:openTree"></span>
<img src="treedata_files/figure-html/openTree-1.svg" alt="Transforming a tree to fan layout. A tree can be transformed to a fan layout by open_tree with a specific angle." width="98%"><p class="caption">
FIGURE 6.7: <strong>Transforming a tree to fan layout.</strong> A tree can be transformed to a fan layout by <code>open_tree</code> with a specific <code>angle</code>.
</p>
</div>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/rotate_tree.html">rotate_tree</a></span><span class="op">(</span><span class="va">p3</span>, <span class="fl">180</span><span class="op">)</span></span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:rotateTree"></span>
<img src="treedata_files/figure-html/rotateTree-1.svg" alt="Rotating tree. A circular/fan layout tree can be rotated by any specific angle." width="98%"><p class="caption">
FIGURE 6.8: <strong>Rotating tree.</strong> A circular/fan layout tree can be rotated by any specific <code>angle</code>.
</p>
</div>
<p>The following example rotates four selected clades (Figure <a href="chapter6.html#fig:rotategif">6.9</a>). It is easy to traverse all the internal nodes and rotate them one-by-one.</p>


<!--

{r eval=F, echo=!knitr::is_latex_output()}
set.seed(2016-05-29)
x <- rtree(50)
p <- ggtree(x) + geom_tiplab()
for (n in reorder(x, 'postorder')$edge[,1] %>% unique) {
    p <- rotate(p, n)
    print(p + geom_point2(aes(subset=(node == n)), color='red'))
}
```


{r rotategif, fig.width=8, fig.height=9.6, echo=FALSE, eval=!knitr::is_latex_output()}
knitr::include_graphics("img/rotate_clade.gif")
```

-->
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2016</span><span class="op">-</span><span class="fl">05</span><span class="op">-</span><span class="fl">29</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html">rtree</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tiplab.html">geom_tiplab</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## nn &lt;- unique(reorder(x, 'postorder')$edge[,1]) </span></span>
<span><span class="co">## to traverse all the internal nodes</span></span>
<span></span>
<span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'postorder'</span><span class="op">)</span><span class="op">$</span><span class="va">edge</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">nn</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/rotate.html">rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">n</span><span class="op">)</span></span>
<span>    <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_point2.html">geom_point2</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>subset<span class="op">=</span><span class="op">(</span><span class="va">node</span> <span class="op">==</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span>, color<span class="op">=</span><span class="st">'red'</span>, size<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/aplot/man/plot_list.html">plot_list</a></span><span class="op">(</span>gglist<span class="op">=</span><span class="va">pp</span>, tag_levels<span class="op">=</span><span class="st">'A'</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:rotategif"></span>
<img src="treedata_files/figure-html/rotategif-1.png" alt="Rotate selected clades. Four clades were randomly selected to rotate (indicated by the red symbol)." width="98%"><p class="caption">
FIGURE 6.9: <strong>Rotate selected clades.</strong> Four clades were randomly selected to rotate (indicated by the red symbol).
</p>
</div>
<!--
{r eval=FALSE, echo=!knitr::is_latex_output()}
set.seed(123)
tr <- rtree(50)
p <- ggtree(tr, layout='circular') + geom_tiplab()

for (angle in seq(0, 270, 10)) {
    print(open_tree(p, angle=angle) + ggtitle(paste("open angle:", angle)))
}
```

{r fangif, fig.width=8, fig.height=9.6, echo=FALSE, fig.cap="<strong>Open tree with different angles.</strong>", fig.scap="Open tree with different angles.", eval=!knitr::is_latex_output()}
knitr::include_graphics("img/fan_layout.gif")
```

-->
<p>Figure <a href="chapter6.html#fig:fangif">6.10</a> demonstrates the usage of <code><a href="https://rdrr.io/pkg/ggtree/man/open_tree.html">open_tree()</a></code> with different open angles.</p>


<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html">rtree</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">tr</span>, layout<span class="op">=</span><span class="st">'circular'</span><span class="op">)</span> </span>
<span><span class="va">angles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">270</span>, length.out<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">angles</span>, <span class="kw">function</span><span class="op">(</span><span class="va">angle</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/open_tree.html">open_tree</a></span><span class="op">(</span><span class="va">p</span>, angle<span class="op">=</span><span class="va">angle</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"open angle:"</span>, <span class="va">angle</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/aplot/man/plot_list.html">plot_list</a></span><span class="op">(</span>gglist<span class="op">=</span><span class="va">pp</span>, tag_levels<span class="op">=</span><span class="st">'A'</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html">rtree</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">tr</span>, layout<span class="op">=</span><span class="st">'circular'</span><span class="op">)</span> </span>
<span><span class="va">angles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">270</span>, length.out<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">angles</span>, <span class="kw">function</span><span class="op">(</span><span class="va">angle</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/open_tree.html">open_tree</a></span><span class="op">(</span><span class="va">p</span>, angle<span class="op">=</span><span class="va">angle</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"open angle:"</span>, <span class="va">angle</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/aplot/man/plot_list.html">plot_list</a></span><span class="op">(</span>gglist<span class="op">=</span><span class="va">pp</span>, tag_levels<span class="op">=</span><span class="st">'A'</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">ggplotify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplotify/man/as.ggplot.html">as.ggplot</a></span><span class="op">(</span><span class="va">g</span>, vjust<span class="op">=</span><span class="op">-</span><span class="fl">.1</span>,scale<span class="op">=</span><span class="fl">1.1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:fangif"></span>
<img src="treedata_files/figure-html/fangif-1.svg" alt="Open tree with different angles." width="98%"><p class="caption">
FIGURE 6.10: <strong>Open tree with different angles.</strong>
</p>
</div>
<p>Figure <a href="chapter6.html#fig:rotatetreegif">6.11</a> illustrates a rotating tree with different angles.</p>
<!--
{r eval=FALSE, echo=!knitr::is_latex_output()}
for (angle in seq(0, 270, 10)) {
    print(rotate_tree(p, angle) + ggtitle(paste("rotate angle:", angle)))
}
```

{r rotatetreegif, fig.width=8, fig.height=9.6, echo=FALSE, eval=!knitr::is_latex_output(), fig.cap="<strong>Rotate tree with different angles.</strong>", fig.scap="Rotate tree with different angles."}
knitr::include_graphics("img/rotate_tree.gif")
```

-->


<div class="figure">
<span style="display:block;" id="fig:rotatetreegif"></span>
<img src="treedata_files/figure-html/rotatetreegif-1.svg" alt="Rotate tree with different angles." width="98%"><p class="caption">
FIGURE 6.11: <strong>Rotate tree with different angles.</strong>
</p>
</div>
<p>Interactive tree manipulation is also possible via the <code><a href="https://rdrr.io/r/graphics/identify.html">identify()</a></code> method (see details described in <a href="chapter12.html#identify">Chapter 12</a>).</p>
</div>
<div id="summary6" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> Summary<a class="anchor" aria-label="anchor" href="#summary6"><i class="fas fa-link"></i></a>
</h2>
<p>A good visualization tool can not only help users to present the data, but it should also be able to help users to explore the data. Data exploration can allow users to better understand the data and also help discover hidden patterns. The <a href="http://bioconductor.org/packages/ggtree"><strong>ggtree</strong></a> provides a set of functions to allow visually manipulating phylogenetic trees and exploring tree structures with associated data. Exploring data in the evolutionary context may help discover new systematic patterns and generate new hypotheses.</p>

<div style="page-break-after: always;"></div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="chapter5.html"><span class="header-section-number">5</span> Phylogenetic Tree Annotation</a></div>
<div class="next"><a href="chapter7.html"><span class="header-section-number">7</span> Plotting tree with data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chapter6"><span class="header-section-number">6</span> Visual Exploration of Phylogenetic Trees</a></li>
<li><a class="nav-link" href="#viewing-selected-clade"><span class="header-section-number">6.1</span> Viewing Selected Clade</a></li>
<li><a class="nav-link" href="#scale-clade"><span class="header-section-number">6.2</span> Scaling Selected Clade</a></li>
<li><a class="nav-link" href="#collapsing-and-expanding-clade"><span class="header-section-number">6.3</span> Collapsing and Expanding Clade</a></li>
<li><a class="nav-link" href="#group-taxa-vis"><span class="header-section-number">6.4</span> Grouping Taxa</a></li>
<li><a class="nav-link" href="#exploring-tree-structure"><span class="header-section-number">6.5</span> Exploring Tree Structure</a></li>
<li><a class="nav-link" href="#summary6"><span class="header-section-number">6.6</span> Summary</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Integration, Manipulation and Visualization of Phylogenetic Trees</strong>" was written by Guangchuang Yu. It was last built on 2022-07-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
